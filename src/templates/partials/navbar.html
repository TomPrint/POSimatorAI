<!-- Navbar start -->
{% if user.is_authenticated %}
  <nav class="navbar navbar-light bg-transparent py-2">
    <div class="{% block nav_class %}container{% endblock %} d-flex align-items-center justify-content-between">
      <a class="navbar-brand fw-bold" href="{% url 'estimations' %}">
        POSimatorAI
      </a>
      <button class="btn btn-brand btn-sm menu-button" id="menuToggle" type="button" data-bs-toggle="offcanvas" data-bs-target="#appNav" aria-controls="appNav">
        <span class="menu-robot" aria-hidden="true">
        <span class="menu-robot-antenna"></span>
        <span class="menu-robot-eyes">
          <span class="menu-robot-eye"></span>
          <span class="menu-robot-eye"></span>
        </span>
        <span class="menu-robot-mouth"></span>
      </span>
        <span>Menu</span>
      </button>
    </div>
  </nav>

  <div class="offcanvas offcanvas-end" tabindex="-1" id="appNav" aria-labelledby="appNavLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="appNavLabel">Nawigacja</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Zamknij"></button>
    </div>
    <div class="offcanvas-body">
      <div class="d-grid gap-2">
        <a class="btn btn-outline-secondary" href="{% url 'estimations' %}">Twórz estymacje</a>
        <a class="btn btn-outline-secondary" href="{% url 'submits-list' %}">Wysłane estymacje</a>
        <a class="btn btn-outline-secondary" href="{% url 'dashboard' %}">Panel admina</a>
        <form method="post" action="{% url 'logout' %}">
          {% csrf_token %}
          <button type="submit" class="btn btn-brand w-100">Wyloguj</button>
        </form>
      </div>
    </div>
  </div>
{% endif %}
<!-- Navbar end -->

<script>
  document.addEventListener("DOMContentLoaded", function () {
    var menuBtn = document.getElementById("menuToggle");
    var offcanvasEl = document.getElementById("appNav");
    if (!menuBtn || !offcanvasEl || !window.bootstrap) {
      return;
    }

    menuBtn.addEventListener("click", function () {
      menuBtn.classList.add("is-active");
      setTimeout(function () {
        menuBtn.classList.remove("is-active");
      }, 700);
    });

    offcanvasEl.addEventListener("show.bs.offcanvas", function () {
      menuBtn.classList.add("menu-open");
    });
    offcanvasEl.addEventListener("hidden.bs.offcanvas", function () {
      menuBtn.classList.remove("menu-open");
    });
  });
</script>
