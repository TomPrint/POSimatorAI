{% extends "base.html" %}
{% load widget_tweaks %}

{% block main_class %}container-fluid{% endblock %}

{% block content %}
<div class="row justify-content-center min-vh-100 px-3">
  <div class="col-12 col-lg-10 col-xl-8">
    <div class="text-center mb-4">
      <div class="brand-logo">
        <span class="brand-mark">P</span>
        POSimatorAI
      </div>
      <h1 class="mt-3 fw-bold mobile-title">Estymacja regału POS</h1>
      <p class="text-muted mobile-text-lg mb-0">Wypełnij pola i sprawdź prognozę kosztów.</p>
    </div>

    <form method="post" class="card card-soft p-4 p-md-5 d-grid gap-3 gap-md-4">
      {% csrf_token %}

      <div class="row g-3 g-md-4">
        {% for field in form %}
          <div class="col-12 col-md-6">
            <label class="form-label mobile-text-lg" for="{{ field.id_for_label }}">
              {{ field.label }}
            </label>
            {% if field.field.widget.input_type == "select" %}
              {{ field|add_class:"form-select form-select-lg" }}
            {% else %}
              {{ field|add_class:"form-control form-control-lg" }}
            {% endif %}
            {% if field.help_text %}
              <div class="form-text">{{ field.help_text }}</div>
            {% endif %}
            {% for error in field.errors %}
              <div class="text-danger small">{{ error }}</div>
            {% endfor %}
          </div>
        {% endfor %}
      </div>

      <button type="submit" class="btn btn-brand btn-lg w-100">Wyceń</button>
    </form>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const tworzywaInput = document.getElementById("id_tworz_m2") || document.getElementById("id_tworzywa_m2");
    const rodzajSelect = document.getElementById("id_rodzaj_tworzywa");

    if (!tworzywaInput || !rodzajSelect) return;

    function updateRodzajTworzywa() {
        if (parseFloat(tworzywaInput.value) > 0) {
            rodzajSelect.disabled = false;
        } else {
            rodzajSelect.disabled = true;
            rodzajSelect.value = ""; // brak wyboru
        }
    }

    // sprawdzenie przy ładowaniu strony
    updateRodzajTworzywa();

    // obserwujemy zmiany w polu tworzywa_m2
    tworzywaInput.addEventListener("input", updateRodzajTworzywa);
});
</script>
{% endblock %}
